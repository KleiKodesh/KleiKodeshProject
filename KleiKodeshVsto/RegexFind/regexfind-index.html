<!doctype html>
<html lang="he">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script type="module" crossorigin>(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const m of document.querySelectorAll('link[rel="modulepreload"]'))g(m);new MutationObserver(m=>{for(const h of m)if(h.type==="childList")for(const w of h.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&g(w)}).observe(document,{childList:!0,subtree:!0});function l(m){const h={};return m.integrity&&(h.integrity=m.integrity),m.referrerPolicy&&(h.referrerPolicy=m.referrerPolicy),m.crossOrigin==="use-credentials"?h.credentials="include":m.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function g(m){if(m.ep)return;m.ep=!0;const h=l(m);fetch(m.href,h)}})();function be(){function t(){typeof window.chrome<"u"&&window.chrome.webview&&window.chrome.webview}function e(n,r=null){const p={Command:n,Args:r!==null?[r]:[]};window.chrome&&window.chrome.webview?window.chrome.webview.postMessage(JSON.stringify(p)):console.warn("WebView2 API not available. Command would be:",JSON.stringify(p,null,2))}function l(){return{searchText:document.getElementById("find-text-input")?.value||"",replaceText:document.getElementById("replace-text-input")?.value||"",searchMode:document.getElementById("search-mode-select")?.value||"All",slop:parseInt(document.getElementById("slop-input")?.value)||0,useRegex:document.getElementById("regex-toggle-button")?.classList.contains("active")||!1,findOptions:g(),replaceOptions:m()}}function g(){return{fontSize:parseInt(document.getElementById("find-font-size-input")?.value)||12,bold:document.getElementById("find-bold-toggle")?.classList.contains("active")||!1,italic:document.getElementById("find-italic-toggle")?.classList.contains("active")||!1,underline:document.getElementById("find-underline-toggle")?.classList.contains("active")||!1,subscript:document.getElementById("find-subscript-toggle")?.classList.contains("active")||!1,superscript:document.getElementById("find-superscript-toggle")?.classList.contains("active")||!1,color:document.getElementById("find-color-button")?.dataset.selectedColor||null,style:document.getElementById("find-style-input")?.value||"",font:document.getElementById("find-font-input")?.value||""}}function m(){return{fontSize:parseInt(document.getElementById("replace-font-size-input")?.value)||12,bold:document.getElementById("replace-bold-toggle")?.classList.contains("active")||!1,italic:document.getElementById("replace-italic-toggle")?.classList.contains("active")||!1,underline:document.getElementById("replace-underline-toggle")?.classList.contains("active")||!1,subscript:document.getElementById("replace-subscript-toggle")?.classList.contains("active")||!1,superscript:document.getElementById("replace-superscript-toggle")?.classList.contains("active")||!1,color:document.getElementById("replace-color-toggle")?.dataset.selectedColor||null,style:document.getElementById("replace-style-input")?.value||"",font:document.getElementById("replace-font-input")?.value||""}}function h(){const n=l();e("search",n)}function w(){const n=l();e("replace",n)}function C(){const n=l();e("replaceAll",n)}function I(n){e("selectResult",{index:n})}function F(){e("PrevResult")}function a(){e("NextResult")}function c(){e("SelectInDoc")}function u(){const n=document.body.classList.contains("dark-theme");e("themeToggle",{theme:n?"light":"dark"})}function L(n,r){e("colorSelected",{color:n,target:r})}function S(n,r,p){e("formatToggle",{option:n,target:r,isActive:p})}function R(n){e("clearFormatting",{target:n})}function G(n){e("copyFormatting",{target:n})}function k(){e("GetFontList")}function W(){e("GetStyleList")}function O(){window.chrome&&window.chrome.webview?window.chrome.webview.addEventListener("message",n=>{V(JSON.parse(n.data))}):window.addEventListener&&window.addEventListener("message",n=>{V(JSON.parse(n.data))})}function V(n){switch(console.log("Received message from C#:",n),console.log("Message command:",n.command),console.log("Message data:",n.data),n.command){case"searchResults":console.log("Processing searchResults with",n.data?.matches?.length||0,"matches"),U(n.data);break;case"replaceComplete":n.data;break;case"success":break;case"error":break;case"fontList":s(n.data);break;case"styleList":d(n.data);break;default:console.warn("Unknown command from C#:",n.command)}}function U(n){const r=document.getElementById("results-list-content");n.matches&&n.matches.length>0?(r.innerHTML=n.matches.map((p,x)=>{const b=i(p.Text.substring(0,p.HighlightStart||0)),v=i(p.Text.substring(p.HighlightStart||0,p.HighlightEnd||p.Text.length)),B=i(p.Text.substring(p.HighlightEnd||p.Text.length));return`
                    <div class="result-item" data-index="${x}" tabindex="0">
                        <div class="result-text">
                            ${b}<mark class="search-highlight">${v}</mark>${B}
                        </div>
                        <div class="result-location">עמוד ${p.Page||"N/A"}, שורה ${p.Line||"N/A"}</div>
                    </div>
                `}).join(""),J(n.matches.length)):r.innerHTML='<div class="no-results">לא נמצאו תוצאות התואמות לחיפוש</div>'}function J(n){document.getElementById("results-list-content").querySelectorAll(".result-item").forEach((f,y)=>{f.addEventListener("click",()=>{v(y)}),f.addEventListener("keydown",M=>{x(M,y,n)})});function x(f,y,M){switch(f.key){case"ArrowDown":f.preventDefault();const fe=Math.min(y+1,M-1);b(fe);break;case"ArrowUp":f.preventDefault();const he=Math.max(y-1,0);b(he);break;case"Enter":f.preventDefault(),v(y);break;case"Escape":f.preventDefault(),B();break}}function b(f){const y=document.querySelectorAll(".result-item");y[f]&&(y.forEach(M=>M.classList.remove("focused")),y[f].classList.add("focused"),y[f].focus(),y[f].scrollIntoView({block:"nearest",behavior:"smooth"}))}function v(f){const y=document.querySelectorAll(".result-item");y[f]&&(y.forEach(M=>M.classList.remove("selected")),y[f].classList.add("selected"),e("SelectResult",{Index:f}))}function B(){document.querySelectorAll(".result-item").forEach(y=>{y.classList.remove("focused","selected")})}n>0&&setTimeout(()=>b(0),100)}function o(n){}function i(n){const r=document.createElement("div");return r.textContent=n,r.innerHTML}function s(n){const r=document.getElementById("find-font-input"),p=document.getElementById("replace-font-input");r&&p&&n&&(r.updateOptions(n),p.updateOptions(n))}function d(n){const r=document.getElementById("find-style-input"),p=document.getElementById("replace-style-input");r&&p&&n&&(r.updateOptions(n),p.updateOptions(n))}return t(),{sendCommand:e,getSearchParameters:l,getFindOptions:g,getReplaceOptions:m,handleSearch:h,handleReplace:w,handleReplaceAll:C,handleSelectResult:I,handlePrevResult:F,handleNextResult:a,handleSelectInDoc:c,handleThemeToggle:u,handleColorSelection:L,handleFormatToggle:S,handleClearFormatting:R,handleCopyFormatting:G,handleGetFontList:k,handleGetStyleList:W,setupMessageListener:O}}window.createWebViewBridge=be;function ye(){const t={fonts:[],isLoaded:!1,callbacks:[]};function e(){return"queryLocalFonts"in window&&typeof window.queryLocalFonts=="function"}async function l(){try{if((await navigator.permissions.query({name:"local-fonts"})).state==="denied")return null;const c=await window.queryLocalFonts();return c&&c.length>0?[...new Set(c.map(L=>L.family))].sort():null}catch{return null}}async function g(){return new Promise(a=>{const c=u=>{u.data&&u.data.command==="fontList"&&(window.removeEventListener("message",c),a(u.data.data))};window.addEventListener("message",c),window.webViewBridge?window.webViewBridge.handleGetFontList():window.chrome&&window.chrome.webview?window.chrome.webview.postMessage(JSON.stringify({Command:"GetFontList",Args:[]})):(window.removeEventListener("message",c),a([]))})}async function m(){if(t.isLoaded)return t.fonts;let a=null;return e()&&(a=await l()),(!a||a.length===0)&&(a=await g()),(!a||a.length===0)&&(a=[]),t.fonts=a,t.isLoaded=!0,t.callbacks.forEach(c=>{try{c(a)}catch(u){console.error("Font callback error:",u)}}),a}async function h(){return t.isLoaded?t.fonts:await m()}function w(a){t.isLoaded?a(t.fonts):t.callbacks.push(a)}function C(a){return t.fonts.includes(a)}function I(a,c=10){if(!a||!t.isLoaded)return t.fonts.slice(0,c);const u=a.toLowerCase();return t.fonts.filter(S=>S.toLowerCase().includes(u)).slice(0,c)}function F(){m().catch(a=>{console.error("Font loading failed:",a),t.fonts=[],t.isLoaded=!0})}return{initialize:F,getFonts:h,onFontsLoaded:w,isFontAvailable:C,getFontSuggestions:I,isFontAccessAPISupported:e()}}window.createFontManager=ye;class ie extends HTMLElement{constructor(){super(),this.state={isOpen:!1,selectedValue:"",filteredOptions:[],focusedIndex:-1,options:[]},this.attachShadow({mode:"open"})}static get observedAttributes(){return["type","placeholder","value","options"]}connectedCallback(){this.render(),this.setupEventListeners(),this.loadInitialOptions()}attributeChangedCallback(e,l,g){if(l!==g)switch(e){case"options":this.updateOptions(this.parseOptions(g));break;case"value":this.setValue(g);break;default:this.shadowRoot&&this.render()}}render(){const e=this.getAttribute("placeholder")||"";this.shadowRoot.innerHTML=`
            <style>
                :host {
                    position: relative;
                    display: flex;
                    align-items: center;
                    flex: 1;
                    min-width: 80px;
                    max-width: 100%;
                }

                .combobox-input {
                    flex: 1;
                    background: var(--primary-background-color, #ffffff);
                    color: var(--text-color, #000000);
                    border: 1px solid var(--border-color, #cccccc);
                    border-radius: var(--border-radius, 4px);
                    padding: 5px 5px 5px 30px;
                    font-size: 14px;
                    transition: font-family 0.2s ease, border-color 0.2s ease;
                    min-width: 0;
                    font-family: inherit;
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                }

                .combobox-input:focus {
                    border-color: var(--accent-color, #0066cc);
                    outline: none;
                }

                .combobox-toggle {
                    position: absolute;
                    left: 5px;
                    background: none;
                    border: none;
                    color: var(--text-color, #000000);
                    cursor: pointer;
                    padding: 2px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    border-radius: 2px;
                    transition: background-color 0.2s ease, transform 0.2s ease;
                }

                .combobox-toggle:hover {
                    background: var(--hover-background-color, rgba(0, 0, 0, 0.1));
                }

                :host([open]) .combobox-toggle {
                    transform: rotate(180deg);
                }

                .combobox-dropdown {
                    position: absolute;
                    top: 100%;
                    left: 0;
                    right: 0;
                    z-index: 1000;
                    background: var(--primary-background-color, #ffffff);
                    border: 2px solid var(--border-color, #cccccc);
                    border-radius: var(--border-radius, 4px);
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                    max-height: 200px;
                    overflow: hidden;
                    margin-top: 2px;
                    display: none;
                }

                :host([open]) .combobox-dropdown {
                    display: block;
                }

                .combobox-options {
                    max-height: 200px;
                    overflow-y: auto;
                    padding: 2px 0;
                }

                .combobox-option {
                    padding: 8px 12px;
                    cursor: pointer;
                    color: var(--text-color, #000000);
                    background: var(--primary-background-color, #ffffff);
                    transition: background-color 0.1s ease;
                    font-size: 14px;
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                }

                .combobox-option:hover,
                .combobox-option.focused {
                    background: var(--hover-background-color, rgba(0, 0, 0, 0.1));
                }

                .combobox-no-options {
                    padding: 8px 12px;
                    color: var(--text-secondary, #666666);
                    font-style: italic;
                    text-align: center;
                }

                /* Font preview specific styling */
                :host([type="font"]) .combobox-option {
                    padding: 10px 12px;
                }

                .combobox-options::-webkit-scrollbar {
                    width: 6px;
                }

                .combobox-options::-webkit-scrollbar-track {
                    background: var(--bg-secondary, #f5f5f5);
                }

                .combobox-options::-webkit-scrollbar-thumb {
                    background: var(--border-color, #cccccc);
                    border-radius: 3px;
                }
            </style>

            <input type="text"
                   class="combobox-input"
                   placeholder="${e}"
                   autocomplete="off">
            <button type="button" class="combobox-toggle" aria-label="Toggle dropdown">
                <svg viewBox="0 0 24 24" width="14" height="14" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M6 9l6 6 6-6"/>
                </svg>
            </button>
            <div class="combobox-dropdown" dir="auto">
                <div class="combobox-options"></div>
            </div>
        `}setupEventListeners(){const e=this.shadowRoot.querySelector(".combobox-input"),l=this.shadowRoot.querySelector(".combobox-toggle");e.addEventListener("input",g=>this.handleInput(g)),e.addEventListener("focus",()=>this.handleFocus()),e.addEventListener("blur",()=>this.handleBlur()),e.addEventListener("keydown",g=>this.handleKeydown(g)),l.addEventListener("click",g=>this.handleToggleClick(g)),document.addEventListener("click",g=>this.handleOutsideClick(g))}loadInitialOptions(){const e=this.getAttribute("options");e&&this.updateOptions(this.parseOptions(e))}parseOptions(e){if(!e)return[];try{return JSON.parse(e)}catch{return e.split(",").map(l=>l.trim())}}handleInput(e){const l=e.target.value;this.state.selectedValue=l,this.filterOptions(l),this.getAttribute("type")==="font"&&l.trim()&&this.applyFontPreview(l),this.state.isOpen||this.openDropdown(),this.dispatchEvent(new CustomEvent("change",{detail:{value:l},bubbles:!0}))}handleFocus(){const e=this.shadowRoot.querySelector(".combobox-input");setTimeout(()=>e.select(),0)}handleBlur(){setTimeout(()=>{!this.shadowRoot.activeElement&&!this.contains(document.activeElement)&&this.closeDropdown()},200)}handleKeydown(e){switch(e.key){case"ArrowDown":e.preventDefault(),this.state.isOpen?this.focusNextOption():this.openDropdown();break;case"ArrowUp":e.preventDefault(),this.state.isOpen&&this.focusPreviousOption();break;case"Enter":e.preventDefault(),this.state.isOpen&&this.state.focusedIndex>=0&&this.selectOption(this.state.filteredOptions[this.state.focusedIndex]);break;case"Escape":e.preventDefault(),this.state.isOpen?this.closeDropdown():this.clearValue();break}}handleToggleClick(e){e.preventDefault(),this.state.isOpen?this.closeDropdown():(this.showAllOptions(),this.shadowRoot.querySelector(".combobox-input").focus())}handleOutsideClick(e){this.contains(e.target)||this.closeDropdown()}filterOptions(e){const l=e.toLowerCase();this.state.filteredOptions=this.state.options.filter(g=>(typeof g=="string"?g:g.name).toLowerCase().includes(l)),this.state.focusedIndex=-1,this.renderOptions()}renderOptions(){const e=this.shadowRoot.querySelector(".combobox-options");if(e.innerHTML="",this.state.filteredOptions.length===0){e.innerHTML='<div class="combobox-no-options">No options found</div>';return}this.state.filteredOptions.forEach((l,g)=>{const m=document.createElement("div");if(m.className="combobox-option",m.setAttribute("dir","auto"),this.getAttribute("type")==="font"){const h=typeof l=="string"?l:l.name,w=`${h} - ABC abc אבג`;m.textContent=w,m.style.fontFamily=`"${h}", sans-serif`}else m.textContent=typeof l=="string"?l:l.name;g===this.state.focusedIndex&&m.classList.add("focused"),m.addEventListener("click",h=>{h.preventDefault(),h.stopPropagation();const w=typeof l=="string"?l:l.name;this.setValue(w),this.closeDropdown(),this.dispatchEvent(new CustomEvent("select",{detail:{value:w,option:l},bubbles:!0})),this.dispatchEvent(new CustomEvent("change",{detail:{value:w},bubbles:!0}))}),e.appendChild(m)})}applyFontPreview(e){const l=this.shadowRoot.querySelector(".combobox-input");e&&e.trim()?l.style.fontFamily=`"${e}", sans-serif`:l.style.fontFamily=""}focusNextOption(){this.state.focusedIndex<this.state.filteredOptions.length-1&&(this.state.focusedIndex++,this.renderOptions(),this.scrollToFocusedOption())}focusPreviousOption(){this.state.focusedIndex>0&&(this.state.focusedIndex--,this.renderOptions(),this.scrollToFocusedOption())}scrollToFocusedOption(){if(this.state.focusedIndex>=0){const l=this.shadowRoot.querySelector(".combobox-options").children[this.state.focusedIndex];l&&l.scrollIntoView({block:"nearest"})}}openDropdown(){this.state.isOpen=!0,this.setAttribute("open",""),this.filterOptions(this.shadowRoot.querySelector(".combobox-input").value)}showAllOptions(){this.state.isOpen=!0,this.setAttribute("open",""),this.state.filteredOptions=[...this.state.options];const e=this.shadowRoot.querySelector(".combobox-input").value;this.state.focusedIndex=this.state.filteredOptions.findIndex(l=>(typeof l=="string"?l:l.name)===e),this.renderOptions(),this.scrollToFocusedOption()}closeDropdown(){this.state.isOpen=!1,this.removeAttribute("open"),this.state.focusedIndex=-1}updateOptions(e){this.state.options=e||[],this.state.isOpen&&this.filterOptions(this.shadowRoot.querySelector(".combobox-input").value)}getValue(){return this.state.selectedValue}setValue(e){this.state.selectedValue=e;const l=this.shadowRoot.querySelector(".combobox-input");l&&(l.value=e,this.getAttribute("type")==="font"&&this.applyFontPreview(e)),this.setAttribute("value",e)}clearValue(){this.setValue(""),this.dispatchEvent(new CustomEvent("clear",{bubbles:!0}))}}customElements.define("custom-combobox",ie);window.CustomCombobox=ie;function xe(){const t={regexTips:[],isVisible:!1};async function e(){window.regexTipsData?(t.regexTips=window.regexTipsData,l()):console.error("Regex tips data not available - window.regexTipsData is missing")}function l(){const a=document.getElementById("help-toggle-button");a&&a.addEventListener("click",c=>{c.preventDefault(),g()})}function g(){document.getElementById("regex-palette")&&(t.isVisible=!t.isVisible,t.isVisible?m():h())}function m(){const a=document.getElementById("regex-palette"),c=document.getElementById("search-results"),u=document.getElementById("help-toggle-button");a&&(a.style.display="flex",console.log("Regex palette display set to flex, computed style:",window.getComputedStyle(a).display),console.log("Regex palette height:",window.getComputedStyle(a).height),w()),c&&(c.style.display="none"),u&&u.classList.add("active")}function h(){const a=document.getElementById("regex-palette"),c=document.getElementById("search-results"),u=document.getElementById("help-toggle-button");a&&(a.style.display="none"),c&&(c.style.display="flex"),u&&u.classList.remove("active")}function w(){const a=document.getElementById("regex-grid");if(!a||t.regexTips.length===0){console.log("populateRegexGrid failed:",{regexGrid:!!a,tipsLength:t.regexTips.length});return}console.log("Populating regex grid with",t.regexTips.length,"tips"),a.innerHTML="",t.regexTips.forEach(c=>{const u=document.createElement("div");u.className="regex-tip",u.innerHTML=`
                <div class="regex-symbol-meaning">
                    <span class="regex-symbol">${I(c.Symbol)}</span>
                    <span class="regex-meaning">${I(c.Meaning)}</span>
                </div>
                <div class="regex-example">${I(c.Example)}</div>
            `,u.addEventListener("click",()=>{C(c.Symbol)}),a.appendChild(u)}),console.log("Regex grid populated, grid height:",window.getComputedStyle(a).height),console.log("Regex grid flex:",window.getComputedStyle(a).flex)}function C(a){const c=document.activeElement;let u=null;if(c&&(c.id==="find-text-input"||c.id==="replace-text-input")?u=c:u=document.getElementById("find-text-input"),u){const L=u.selectionStart,S=u.value.substring(0,L),R=u.value.substring(u.selectionEnd);u.value=S+a+R,u.focus(),u.setSelectionRange(L+a.length,L+a.length)}}function I(a){const c=document.createElement("div");return c.textContent=a,c.innerHTML}function F(){const a=document.getElementById("regex-palette"),c=document.getElementById("search-results"),u=document.getElementById("help-toggle-button");a&&(a.style.display="none"),c&&(c.style.display="flex"),u&&u.classList.remove("active"),t.isVisible=!1}return{initialize:e,toggle:g,show:m,hide:h,hideForSearch:F,insertSymbol:C}}window.createRegexPalette=xe;function ve(){document.querySelectorAll(".toggle-button").forEach(e=>{e.addEventListener("click",function(){this.classList.toggle("active")})})}document.addEventListener("DOMContentLoaded",ve);function we(){const t={currentColorTarget:null,colorPickerOverlay:null,colorPicker:null},e={base:[{name:"Text 1",hex:"#000000",themeIndex:13,decimal:null},{name:"Background 1",hex:"#FFFFFF",themeIndex:12,decimal:null},{name:"Text 2",hex:"#44546A",themeIndex:15,decimal:null},{name:"Background 2",hex:"#E7E6E6",themeIndex:14,decimal:null},{name:"Accent 1",hex:"#4472C4",themeIndex:4,decimal:null},{name:"Accent 2",hex:"#E15759",themeIndex:5,decimal:null},{name:"Accent 3",hex:"#70AD47",themeIndex:6,decimal:null},{name:"Accent 4",hex:"#FFC000",themeIndex:7,decimal:null},{name:"Accent 5",hex:"#5B9BD5",themeIndex:8,decimal:null},{name:"Accent 6",hex:"#A5A5A5",themeIndex:9,decimal:null}],variations:[{label:"Lighter 80%",tint:.8,tintValue:51},{label:"Lighter 60%",tint:.6,tintValue:102},{label:"Lighter 40%",tint:.4,tintValue:153},{label:"Darker 25%",shade:.25,shadeValue:191},{label:"Darker 50%",shade:.5,shadeValue:127}]},l=[{name:"Dark Red",hex:"#C00000",decimal:null},{name:"Red",hex:"#FF0000",decimal:null},{name:"Orange",hex:"#FFC000",decimal:null},{name:"Yellow",hex:"#FFFF00",decimal:null},{name:"Light Green",hex:"#92D050",decimal:null},{name:"Green",hex:"#00B050",decimal:null},{name:"Light Blue",hex:"#00B0F0",decimal:null},{name:"Blue",hex:"#0070C0",decimal:null},{name:"Dark Blue",hex:"#002060",decimal:null},{name:"Purple",hex:"#7030A0",decimal:null}];function g(o){if(!o||o==="null")return null;const i=o.replace("#","");if(i.length!==6)return null;const s=parseInt(i.substring(0,2),16),d=parseInt(i.substring(2,4),16);return parseInt(i.substring(4,6),16)<<16|d<<8|s}function m(o){if(o==null)return null;if(o===-16777216)return"#000000";if(o<0)return h(o);const i=o>>16&255,s=o>>8&255;return`#${(o&255).toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")}${i.toString(16).padStart(2,"0")}`.toUpperCase()}function h(o){if(o<0){const s=o>>>0,d=s>>24&255,n=s>>8&255,r=s&255;if((d&240)===240){const p=d&15;let x=0;const b=255;n!==b&&(x=Math.round((-1+n/255)*100)/100),r!==b&&(x=Math.round((1-r/255)*100)/100);const v=w(p);if(v)return F(v,x)}}return{"-603914241":"#000000","-587137025":"#FFFFFF","-570359809":"#44546A","-553582593":"#E7E6E6","-738131969":"#4472C4","-721354753":"#E15759","-704577537":"#70AD47","-687800321":"#FFC000","-671023105":"#5B9BD5","-654245889":"#A5A5A5"}[o.toString()]||"#000000"}function w(o){const i=e.base.find(s=>s.themeIndex===o);return i?i.hex:null}function C(o,i,s){o/=255,i/=255,s/=255;const d=Math.max(o,i,s),n=Math.min(o,i,s);let r,p,x=(d+n)/2;if(d===n)r=p=0;else{const b=d-n;switch(p=x>.5?b/(2-d-n):b/(d+n),d){case o:r=(i-s)/b+(i<s?6:0);break;case i:r=(s-o)/b+2;break;case s:r=(o-i)/b+4;break}r/=6}return[r,p,x]}function I(o,i,s){let d,n,r;if(i===0)d=n=r=s;else{const p=(v,B,f)=>(f<0&&(f+=1),f>1&&(f-=1),f<.16666666666666666?v+(B-v)*6*f:f<.5?B:f<.6666666666666666?v+(B-v)*(.6666666666666666-f)*6:v),x=s<.5?s*(1+i):s+i-s*i,b=2*s-x;d=p(b,x,o+1/3),n=p(b,x,o),r=p(b,x,o-1/3)}return[Math.round(d*255),Math.round(n*255),Math.round(r*255)]}function F(o,i){const s=o.replace("#",""),d=parseInt(s.substring(0,2),16),n=parseInt(s.substring(2,4),16),r=parseInt(s.substring(4,6),16),[p,x,b]=C(d,n,r);let v;i>0?v=b+(1-b)*i:v=b*(1+i),v=Math.max(0,Math.min(1,v));const[B,f,y]=I(p,x,v);return`#${B.toString(16).padStart(2,"0")}${f.toString(16).padStart(2,"0")}${y.toString(16).padStart(2,"0")}`.toUpperCase()}function a(o,i){let s=255,d=255;i<0?(s=Math.round((i+1)*255),s=Math.max(0,Math.min(255,s))):i>0&&(d=Math.round((1-i)*255),d=Math.max(0,Math.min(255,d)));const r=(240|o&15)<<24|0|s<<8|d;return r>2147483647?r-4294967296:r}function c(){e.base.forEach(o=>{o.decimal=a(o.themeIndex,0)}),l.forEach(o=>{o.decimal=g(o.hex)})}function u(){t.colorPickerOverlay=document.getElementById("color-picker-overlay"),t.colorPicker=document.getElementById("color-picker"),c(),L(),R()}function L(){const o=document.getElementById("theme-colors-grid");o.innerHTML="",e.base.forEach(s=>{const d=S(s.hex,{type:"theme",name:s.name,themeIndex:s.themeIndex,decimal:s.decimal,tintShade:0});o.appendChild(d)}),e.variations.forEach(s=>{e.base.forEach(d=>{const n=s.tint?s.tint:-s.shade,r=F(d.hex,n),p=a(d.themeIndex,n),x=S(r,{type:"theme",name:`${d.name} ${s.label}`,themeIndex:d.themeIndex,decimal:p,tintShade:n});o.appendChild(x)})});const i=document.getElementById("standard-colors-grid");i.innerHTML="",l.forEach(s=>{const d=S(s.hex,{type:"standard",name:s.name,decimal:s.decimal});i.appendChild(d)}),document.querySelector(".auto-color").addEventListener("click",()=>{O("#000000",{type:"auto",name:"Automatic",decimal:-16777216})}),document.querySelector(".no-color").addEventListener("click",()=>{O(null,{type:"none",name:"No Color",decimal:null})})}function S(o,i){const s=document.createElement("button");return s.className="color-swatch",s.style.backgroundColor=o,s.setAttribute("data-color",o),s.setAttribute("data-color-info",JSON.stringify(i)),s.title=i.name||o,s.addEventListener("click",()=>O(o,i)),s}function R(){document.getElementById("color-picker-close").addEventListener("click",()=>k()),t.colorPickerOverlay.addEventListener("click",s=>{s.target===t.colorPickerOverlay&&k()}),document.getElementById("more-colors-btn").addEventListener("click",s=>{s.preventDefault(),W()}),document.addEventListener("keydown",s=>{s.key==="Escape"&&t.colorPickerOverlay.style.display==="flex"&&k()})}function G(o){t.currentColorTarget=o,t.colorPickerOverlay.style.display="flex";const i=o.getBoundingClientRect();t.colorPicker.classList.remove("position-top"),i.bottom+400>window.innerHeight&&t.colorPicker.classList.add("position-top")}function k(){t.colorPickerOverlay.style.display="none",t.currentColorTarget=null}function W(){const o=t.currentColorTarget;k();const i=document.createElement("input");i.type="color",i.style.position="absolute",i.style.left="-9999px",i.style.opacity="0",o&&o.getAttribute("data-selected-color")&&(i.value=o.getAttribute("data-selected-color")),document.body.appendChild(i),i.addEventListener("change",s=>{const d=s.target.value;t.currentColorTarget=o,O(d,{type:"custom",name:"Custom Color",decimal:g(d)}),document.body.removeChild(i)}),i.addEventListener("blur",()=>{setTimeout(()=>{document.body.contains(i)&&document.body.removeChild(i)},100)}),i.click()}function O(o,i){t.currentColorTarget&&(o?(t.currentColorTarget.style.borderBottom=`3px solid ${o}`,t.currentColorTarget.setAttribute("data-selected-color",o),t.currentColorTarget.setAttribute("data-color-data",JSON.stringify(i)),t.currentColorTarget.classList.add("active")):(t.currentColorTarget.style.borderBottom="",t.currentColorTarget.removeAttribute("data-selected-color"),t.currentColorTarget.removeAttribute("data-color-data"),t.currentColorTarget.classList.remove("active")),t.currentColorTarget.id==="find-color-button"?V("find",i):t.currentColorTarget.id==="replace-color-toggle"&&V("replace",i)),k()}function V(o,i){window.createWebViewBridge?window.createWebViewBridge().handleColorSelection(i,o):console.warn("WebViewBridge not available. Color change would be sent to C# with:",{context:o,colorData:i})}function U(o){const i=document.getElementById(o);if(!i)return null;const s=i.getAttribute("data-color-data");if(!s)return null;try{return JSON.parse(s)}catch{return null}}function J(){if(window.createWebViewBridge){const o=window.createWebViewBridge();return{findOptions:o.getFindOptions(),replaceOptions:o.getReplaceOptions(),searchParameters:o.getSearchParameters()}}return null}return{initialize:u,show:G,hide:k,selectColor:O,getCurrentColorData:U,getAllFormattingState:J,hexToWordDecimal:g,wordDecimalToHex:m}}window.createColorPicker=we;let Z=document.getElementById("show-replace-button"),Ee=document.getElementById("theme-toggle-button"),Le=document.getElementById("find-button"),se=document.getElementById("regex-toggle-button"),Y=document.getElementById("find-bold-toggle"),Q=document.getElementById("find-italic-toggle"),X=document.getElementById("find-underline-toggle"),_=document.getElementById("find-subscript-toggle"),ee=document.getElementById("find-superscript-toggle"),A=document.getElementById("find-color-button"),Ie=document.getElementById("find-clear-button"),Se=document.getElementById("find-dipper-button"),Be=document.getElementById("replace-button"),Ce=document.getElementById("replace-all-button"),le=document.getElementById("replace-bold-toggle"),ae=document.getElementById("replace-italic-toggle"),re=document.getElementById("replace-underline-toggle"),ce=document.getElementById("replace-subscript-toggle"),de=document.getElementById("replace-superscript-toggle"),D=document.getElementById("replace-color-toggle"),Fe=document.getElementById("replace-options-clear-button"),ke=document.getElementById("replace-options-dipper-button"),ue=document.getElementById("search-mode-select"),pe=document.getElementById("slop-input"),P=document.getElementById("find-text-input"),te=document.getElementById("find-font-size-input"),z=document.getElementById("replace-text-input"),me=document.getElementById("replace-font-size-input"),$=document.getElementById("find-style-input"),ne=document.getElementById("find-font-input"),H=document.getElementById("replace-style-input"),ge=document.getElementById("replace-font-input"),N,q,T,j;function oe(){return{Text:P.value,Bold:Y.classList.contains("active"),Italic:Q.classList.contains("active"),Underline:X.classList.contains("active"),Superscript:ee.classList.contains("active"),Subscript:_.classList.contains("active"),Style:$.getValue(),Font:ne.getValue(),FontSize:parseInt(te.value)||null,Mode:ue.value,Slop:parseInt(pe.value)||0,UseWildcards:se.classList.contains("active"),Replace:{Text:"",Bold:!1,Italic:!1,Underline:!1,Superscript:!1,Subscript:!1,Style:"",Font:"",FontSize:null}}}function K(){return{Text:P.value,Bold:Y.classList.contains("active"),Italic:Q.classList.contains("active"),Underline:X.classList.contains("active"),Superscript:ee.classList.contains("active"),Subscript:_.classList.contains("active"),Style:$.getValue(),Font:ne.getValue(),FontSize:parseInt(te.value)||null,Mode:ue.value,Slop:parseInt(pe.value)||0,UseWildcards:se.classList.contains("active"),Replace:{Text:z.value,Bold:le.classList.contains("active"),Italic:ae.classList.contains("active"),Underline:re.classList.contains("active"),Superscript:de.classList.contains("active"),Subscript:ce.classList.contains("active"),Style:H.getValue(),Font:ge.getValue(),FontSize:parseInt(me.value)||null}}}function E(t,e){if(q)q.sendCommand(t,e);else{const l={command:t,data:e,timestamp:new Date().toISOString()};window.chrome&&window.chrome.webview?window.chrome.webview.postMessage(JSON.stringify(l)):console.warn("WebView2 API not available. Command would be:",JSON.stringify(l,null,2))}}function Te(){A.addEventListener("click",t=>{t.preventDefault(),N.show(A)}),D.addEventListener("click",t=>{t.preventDefault(),N.show(D)}),Z.addEventListener("click",t=>{t.preventDefault();const e=document.getElementById("search-replace-container");window.getComputedStyle(e).display==="none"?(e.style.display="flex",e.style.flexDirection="column",e.style.gap="5px",Z.classList.add("active")):(e.style.display="none",Z.classList.remove("active"))})}function Oe(){Le.addEventListener("click",t=>{t.preventDefault(),T&&T.hideForSearch&&T.hideForSearch();const e=oe();E("Search",e)}),Be.addEventListener("click",t=>{t.preventDefault();const e=K();E("Replace",e)}),Ce.addEventListener("click",t=>{t.preventDefault();const e=K();E("ReplaceAll",e)}),Ee.addEventListener("click",t=>{t.preventDefault(),document.body.classList.toggle("dark");const e=document.body.classList.contains("dark");E("ThemeToggle",{Theme:e?"dark":"light"})}),Ie.addEventListener("click",t=>{t.preventDefault(),Y.classList.remove("active"),Q.classList.remove("active"),X.classList.remove("active"),_.classList.remove("active"),ee.classList.remove("active"),A.removeAttribute("data-selected-color"),A.removeAttribute("data-color-data"),A.classList.remove("active"),A.style.borderBottom="",te.value="12",$.setValue(""),ne.setValue("")}),Fe.addEventListener("click",t=>{t.preventDefault(),le.classList.remove("active"),ae.classList.remove("active"),re.classList.remove("active"),ce.classList.remove("active"),de.classList.remove("active"),D.removeAttribute("data-selected-color"),D.removeAttribute("data-color-data"),D.classList.remove("active"),D.style.borderBottom="",me.value="12",H.setValue(""),ge.setValue("")}),Se.addEventListener("click",t=>{t.preventDefault(),E("GetFontList",{})}),ke.addEventListener("click",t=>{t.preventDefault(),E("GetFontList",{})}),P.addEventListener("keypress",t=>{if(t.key==="Enter"){t.preventDefault(),T&&T.hideForSearch&&T.hideForSearch();const e=oe();E("Search",e)}}),z.addEventListener("keypress",t=>{if(t.key==="Enter"){t.preventDefault();const e=K();E("Replace",e)}}),P.addEventListener("keydown",t=>{t.key==="Escape"&&(t.preventDefault(),P.value="",P.focus())}),z.addEventListener("keydown",t=>{t.key==="Escape"&&(t.preventDefault(),z.value="",z.focus())}),$&&$.addEventListener("focus",()=>{E("GetStyleList",{})}),H&&H.addEventListener("focus",()=>{E("GetStyleList",{})}),E("GetFontList",{})}document.addEventListener("DOMContentLoaded",()=>{typeof createColorPicker<"u"&&(N=createColorPicker(),N.initialize()),typeof createWebViewBridge<"u"&&(q=createWebViewBridge(),q.setupMessageListener()),typeof createRegexPalette<"u"&&(T=createRegexPalette(),T.initialize()),typeof createFontManager<"u"&&(j=createFontManager(),j.initialize(),j.onFontsLoaded(t=>{const e=document.getElementById("find-font-input"),l=document.getElementById("replace-font-input");e&&l&&(e.updateOptions(t),l.updateOptions(t))})),Te(),Oe()});const Me=[{Symbol:".",Meaning:"כל תו בודד",Example:"a.b → acb, a1b"},{Symbol:"*",Meaning:"אפס או יותר מהאלמנט הקודם",Example:"a* → '', a, aa"},{Symbol:"+",Meaning:"אחד או יותר מהאלמנט הקודם",Example:"a+ → a, aa"},{Symbol:"?",Meaning:"אפס או אחד מהאלמנט הקודם",Example:"a? → '', a"},{Symbol:"\\d",Meaning:"ספרה",Example:"\\d → 0-9"},{Symbol:"\\w",Meaning:"תו מילה",Example:"\\w → a-z, 0-9, ＿"},{Symbol:"\\s",Meaning:"רווח לבן",Example:"\\s → רווח, טאבים, שורות חדשות"},{Symbol:"[abc]",Meaning:"כל אחד מ-א', ב', או ג'",Example:"[אבג] → או א' או ב' או ג'"},{Symbol:"[0-9]",Meaning:"כל ספרה",Example:"[0-9] → ספרה כלשהי"},{Symbol:"[a-z]",Meaning:"טווח a עד z",Example:"[a-z] → לאותיות קטנות"},{Symbol:"[A-Z]",Meaning:"טווח A עד Z",Example:"[A-Z] → לאותיות גדולות"},{Symbol:"^",Meaning:"תחילת מחרוזת או שורה",Example:"^אבג → המחרוזת אבג בתחילה"},{Symbol:"$",Meaning:"סיום מחרוזת או שורה",Example:"אבג$ → המחרוזת אבג בסוף"},{Symbol:"\\",Meaning:"תו בריחה (מגדיר תו מיוחד כתו רגיל)",Example:"\\* → כוכבית ממש"},{Symbol:"|",Meaning:"אלטרנטיבה (או)",Example:"שור|כבש → או שור או כבש"},{Symbol:"(...)",Meaning:"קבוצת לכידה",Example:"(אב)+ → תואם אב, אבאב"},{Symbol:"\\b",Meaning:"גבול מילה",Example:"\\bכבש\\b → כבש אבל לא כבשה"},{Symbol:"\\D",Meaning:"כל תו שאינו ספרה",Example:"\\D → למשל: או a או '!'"},{Symbol:"\\W",Meaning:"כל תו שאינו תו מילה",Example:"\\W → ' ', '!'"},{Symbol:"\\S",Meaning:"כל תו שאינו רווח לבן",Example:"\\S → כל תו שאיננו רווח, טאב או שורה חדשה"},{Symbol:"[^abc]",Meaning:"(הגדרה בשלילה) לא א' או ב' או ג'",Example:"[^אבג] → כל תו שאיננו בטווח זה"},{Symbol:".*?",Meaning:"התאמה עצלה",Example:"(ב.*?) או (ב+?)→ בב מתוך בבבב"},{Symbol:"{n}",Meaning:"בדיוק n חזרות",Example:"a{3} → aaa"},{Symbol:"{n,}",Meaning:"לפחות n חזרות",Example:"a{2,} → aa, aaa"},{Symbol:"{n,m}",Meaning:"בין n ל-m חזרות",Example:"a{2,4} → aa, aaa, aaaa"},{Symbol:"$1",Meaning:"התייחסות לקבוצה",Example:"$1 → קבוצה מספר 1"},{Symbol:"\\b.*?",Meaning:"תחיליות",Example:"\\b.*?חר\\b → תואם אחר או מחר"},{Symbol:".*?\\b",Meaning:"סופיות",Example:"\\bאח.*?\\b → תואם אח או אחר"},{Symbol:"\\B",Meaning:"לא גבול מילה",Example:"\\Bכבש\\B → בתוך קטלוג"},{Symbol:"\\A",Meaning:"תחילת מחרוזת (לא שורה)",Example:"\\Aאבג → רק בתחילת מחרוזת"},{Symbol:"\\Z",Meaning:"סיום לפני שורת סיום אופציונלית",Example:"אבג\\Z → בסיום מחרוזת"},{Symbol:"\\z",Meaning:"סיום מוחלט של מחרוזת",Example:"אבג\\z → לסיום מוחלט"},{Symbol:"(?:...)",Meaning:"קבוצה לא לוכדת",Example:"(?:ab)+ → ללא לכידה"},{Symbol:"(?=...)",Meaning:"ציפייה חיובית",Example:"א(?=ב) → תואם א לפני ב"},{Symbol:"(?!...)",Meaning:"ציפייה שלילית",Example:"א(?!ב) → תואם א לא לפני ב"},{Symbol:"(?<=...)",Meaning:"ציפייה לאחור חיובית",Example:"(?<=א)ב → תואם ב אחרי א"},{Symbol:"(?<!...)",Meaning:"ציפייה לאחור שלילית",Example:"(?<!א)ב → האות ב לא אחרי א"}];window.regexTipsData=Me;document.addEventListener("DOMContentLoaded",async()=>{if(console.log("Initializing Regex Find Tool..."),typeof RegexPalette<"u"){const t=new RegexPalette;await t.initialize(),window.regexPalette=t}if(typeof ColorPicker<"u"){const t=new ColorPicker;t.initialize(),window.colorPicker=t}if(typeof WebViewBridge<"u"){const t=new WebViewBridge;t.setupMessageListener(),window.webViewBridge=t}console.log("Regex Find Tool initialized successfully")});</script>
    <style rel="stylesheet" crossorigin>:root{--icon-size: 20px;--app-zoom: 1;--border-radius: 4px;--border-color: rgba(0, 0, 0, .0578);--focus-color: rgba(0, 95, 184, .3);--focus-offset: 3px;--border-radius: 6px;--secondary-background-color: #f9f9f9;--primary-background-color: #ffffff;--text-color: rgba(0, 0, 0, .8956);--icon-color: rgba(0, 0, 0, .6063);--accent-color: #005fb8;--hover-background-color: rgba(0, 0, 0, .0373);--icon-color-filter: none;--bg-primary: var(--primary-background-color);--bg-secondary: var(--secondary-background-color);--text-primary: var(--text-color);--text-secondary: rgba(0, 0, 0, .6063);--accent-bg: rgba(0, 95, 184, .1);--hover-bg: rgba(0, 0, 0, .0373);--active-bg: rgba(0, 0, 0, .0578)}.dark{--border-color: rgba(255, 255, 255, .0578);--secondary-background-color: #1c1c1c;--primary-background-color: #202020;--text-color: rgba(255, 255, 255, 1);--icon-color: rgba(255, 255, 255, .786);--hover-background-color: rgba(255, 255, 255, .0605);--icon-color-filter: brightness(0) saturate(100%) invert(79%) sepia(6%) saturate(346%) hue-rotate(202deg) brightness(95%) contrast(87%);--bg-primary: var(--primary-background-color);--bg-secondary: var(--secondary-background-color);--text-primary: var(--text-color);--text-secondary: rgba(255, 255, 255, .786);--hover-bg: rgba(255, 255, 255, .0605);--active-bg: rgba(255, 255, 255, .0837)}input,select{background-color:var(--primary-background-color);color:var(--text-color);border-color:var(--border-color)}input:focus,select:focus{border-color:var(--accent-color);outline:none}:root.dark *{scrollbar-color:rgba(255,255,255,.3) var(--secondary-background-color)}:root.dark ::-webkit-scrollbar-track{background:var(--primary-background-color)}button{background:transparent;border:none;cursor:pointer;border-radius:2px;padding:4px;align-items:center;justify-content:center;display:flex;gap:5px;border-radius:var(--border-radius)}button:hover{background-color:var(--hover-background-color)}button:active{opacity:.9;transform:scale(.95)}button img{width:var(--icon-size);aspect-ratio:1 / 1;filter:var(--icon-color-filter)}.toggle-button.active{background-color:var(--active-bg)}*{margin:0;padding:0;color:var(--text-primary);box-sizing:border-box;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;transition:none!important;animation:none!important}html,body{height:100%;overflow:hidden}body{height:100%;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;font-size:14px;background-color:var(--bg-primary);color:var(--text-primary);zoom:var(--app-zoom);direction:rtl;display:flex;flex-direction:column}:focus{outline:none}input{background:none;border:var(--border-color) 1px solid;border-radius:var(--border-radius);padding:5px;min-width:0}input[type=number]{width:6ch;text-align:center}input[list]{flex:1}select{background:var(--primary-background-color);color:var(--text-color);border:var(--border-color) 1px solid;border-radius:var(--border-radius);padding:5px 2px}select:focus{border-color:var(--accent-color);outline:none}select option{background:var(--primary-background-color);color:var(--text-color)}select option:hover{background:var(--hover-background-color)}select option:checked{background:var(--accent-color);color:var(--primary-background-color)}datalist{background:var(--primary-background-color);border:var(--border-color) 1px solid;border-radius:var(--border-radius)}datalist option{background:var(--primary-background-color);color:var(--text-color);padding:5px}datalist option:hover{background:var(--hover-background-color)}#find-font-input,#replace-font-input{transition:font-family .2s ease}#find-style-input,#replace-style-input{font-family:inherit}.flex-row{display:flex;flex-direction:row;justify-content:space-between;align-items:center;gap:5px;flex-wrap:wrap}.container{display:flex;flex-direction:column;gap:5px;padding:10px}#title-bar{display:flex;flex-wrap:wrap;gap:5px;justify-content:space-between;padding:5px 10px;border-bottom:.5px solid var(--border-color);background:var(--secondary-background-color)}#title-bar label{margin-right:5px;font-size:.9em}#title-bar button img{padding:2px}#show-replace-button{padding:0 6px 0 10px;border:var(--border-color) 1px solid}#show-replace-button img{padding:4px!important}#content{display:flex;flex-direction:column;gap:5px;flex:1;overflow:hidden}.search-button img{padding:1px}#search-replace-container{background:var(--secondary-background-color);border-top:.5px solid var(--border-color);border-bottom:.5px solid var(--border-color)}.search-replace-button img{padding:3px}#results-container{flex:1;display:flex;flex-direction:column;overflow:hidden;min-height:0}.regex-palette{flex:1;display:flex;flex-direction:column;overflow:hidden;background:var(--secondary-background-color);border-top:.5px solid var(--border-color)}.regex-grid{flex:1;overflow-y:auto;background:var(--primary-background-color);padding:5px;display:flex;flex-direction:column;gap:2px}.regex-tip{padding:4px 8px;cursor:pointer;transition:background-color .1s ease;width:100%;border-radius:var(--border-radius, 4px);flex-shrink:0;min-height:auto}.regex-tip:hover{background:var(--hover-background-color)}.regex-symbol-meaning{display:flex;gap:10px;align-items:baseline;margin-bottom:2px}.regex-symbol{font-weight:700;font-family:Courier New,monospace;font-size:1em;color:var(--accent-color);min-width:60px;flex-shrink:0}.regex-meaning{font-weight:400;flex:1;line-height:1.2;font-size:.9em}.regex-example{font-size:.8em;opacity:.7;font-family:Courier New,monospace;margin-right:60px;line-height:1.1;color:var(--text-secondary, var(--text-color))}.search-results{flex:1;display:flex;flex-direction:column;overflow:hidden}.results-list{flex:1;overflow-y:auto;background:var(--primary-background-color);padding:5px}.result-item{padding:8px 12px;margin:2px 0;border:1px solid transparent;border-radius:var(--border-radius);cursor:pointer;transition:all .2s ease;background:var(--primary-background-color);outline:none}.result-item:hover{background:var(--hover-background-color);border-color:var(--border-color)}.result-item.focused{background:var(--accent-color-light, rgba(0, 102, 204, .1));border-color:var(--accent-color)}.result-item.selected{background:var(--accent-color);color:var(--primary-background-color);border-color:var(--accent-color)}.result-item.selected .result-location{color:var(--primary-background-color);opacity:.9}.result-text{font-size:14px;line-height:1.4;margin-bottom:4px;word-wrap:break-word;color:var(--text-color)}.search-highlight{background:var(--highlight-color, #ffff00);color:var(--highlight-text-color, #000000);padding:1px 2px;border-radius:2px;font-weight:700}.result-item.selected .search-highlight{background:var(--primary-background-color);color:var(--accent-color)}.result-location{font-size:12px;color:var(--text-color);opacity:.7}.no-results{padding:20px;text-align:center;color:var(--text-secondary);font-style:italic}.dark .search-highlight{background:var(--highlight-color-dark, #ffd700);color:var(--highlight-text-color-dark, #000000)}.results-list::-webkit-scrollbar{width:6px}.results-list::-webkit-scrollbar-track{background:var(--bg-secondary)}.results-list::-webkit-scrollbar-thumb{background:var(--border-color);border-radius:3px}.results-list::-webkit-scrollbar-thumb:hover{background:var(--text-secondary)}.regex-grid::-webkit-scrollbar{width:6px}.regex-grid::-webkit-scrollbar-track{background:var(--secondary-background-color)}.regex-grid::-webkit-scrollbar-thumb{background:var(--border-color);border-radius:3px}.regex-grid::-webkit-scrollbar-thumb:hover{background:var(--text-secondary)}:root.dark .regex-grid::-webkit-scrollbar-track{background:var(--primary-background-color)}:root.dark .regex-grid::-webkit-scrollbar-thumb{background:#ffffff4d}:root.dark .regex-grid::-webkit-scrollbar-thumb:hover{background:#ffffff80}.color-picker-overlay{position:fixed;inset:0;background:#0000001a;z-index:1000;display:flex;align-items:center;justify-content:center;padding:20px}.color-picker{background:var(--primary-background-color, #ffffff);border:1px solid var(--border-color, #e1dfdd);border-radius:4px;box-shadow:0 4px 12px #00000026;width:240px;max-height:calc(100vh - 40px);direction:rtl;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;overflow:hidden;display:flex;flex-direction:column}.color-picker.position-top{align-self:flex-start;margin-top:20px}.color-picker-header{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:var(--secondary-background-color, #f3f2f1);border-bottom:1px solid var(--border-color, #e1dfdd);font-size:16px;font-weight:500;flex-shrink:0}.close-btn{background:none;border:none;font-size:18px;cursor:pointer;padding:0;width:24px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:2px;color:var(--text-color, #484644)}.close-btn:hover{background:var(--hover-background-color, #edebe9)}.color-picker-content{padding:16px;overflow-y:auto;flex:1;min-height:0}.auto-no-colors{display:grid;grid-template-columns:1fr 1fr;gap:4px;margin-bottom:8px}.color-option{display:flex;align-items:center;gap:8px;padding:8px 12px;background:transparent;border:none;cursor:pointer;border-radius:2px;font-size:14px;text-align:right;transition:background-color .15s ease;white-space:nowrap;min-width:0}.color-option:hover{background:var(--secondary-background-color, #f3f2f1)}.color-preview{width:18px;height:18px;border-radius:1px;flex-shrink:0}.no-color-preview{border:1px solid var(--border-color, #c8c6c4);background:var(--primary-background-color, #ffffff)}.separator{height:1px;background:var(--border-color, #e1dfdd);margin:8px 0}.color-section{margin-bottom:8px}.section-title{font-size:12px;font-weight:600;margin-bottom:6px;color:var(--text-color, #484644)}.color-grid{display:flex;flex-wrap:wrap;gap:2px;justify-content:center}.theme-colors-container{display:grid;grid-template-columns:repeat(10,1fr);gap:1px;justify-content:center;max-width:100%}.theme-colors-container .color-swatch{width:20px;height:20px;margin:1px}.color-swatch{width:30px;height:30px;border:1px solid white;cursor:pointer;transition:transform .1s ease;outline:none;margin:2px;border:solid .5px lightgray}.color-swatch:hover{transform:scale(1.1);box-shadow:0 2px 4px #0003}.color-swatch:focus{outline:2px solid var(--accent-color, #0078d4);outline-offset:1px}.more-colors-btn{display:flex;align-items:center;gap:8px;width:100%;padding:8px;background:transparent;border:none;cursor:pointer;border-radius:2px;text-align:right;transition:background-color .15s ease;color:var(--accent-color, #0078d4)}.more-colors-btn:hover{background:var(--secondary-background-color, #f3f2f1)}.more-colors-btn .icon{flex-shrink:0}.color-btn{border-bottom:3px solid transparent;transition:border-bottom-color .2s ease}.color-btn[data-selected-color] .icon{opacity:.8}#search-replace-container{display:none}.input-wrapper{display:flex;flex-direction:row;align-items:center;gap:5px;border:var(--border-color) 1px solid;border-radius:4px}.input-wrapper:focus-within{border-bottom:var(--accent-color) solid 2px}.input-wrapper>input[type=text]{flex:1;border:none;padding:0 7px}.input-wrapper>button>img{width:18px}.custom-combobox{position:relative;display:flex;align-items:center;flex:1}.combobox-input{flex:1;background:var(--primary-background-color);color:var(--text-color);border:var(--border-color) 1px solid;border-radius:var(--border-radius);padding:5px 30px 5px 5px;font-size:14px;transition:font-family .2s ease,border-color .2s ease;min-width:0}.combobox-input:focus{border-color:var(--accent-color);outline:none}.combobox-toggle{position:absolute;right:5px;background:none;border:none;color:var(--text-color);cursor:pointer;padding:2px;display:flex;align-items:center;justify-content:center;border-radius:2px;transition:background-color .2s ease}.combobox-toggle:hover{background:var(--hover-background-color)}.combobox-toggle:focus{outline:none;background:var(--hover-background-color)}.custom-combobox.open .combobox-toggle svg{transform:rotate(180deg)}.combobox-dropdown{position:absolute;top:100%;left:0;right:0;z-index:1000;background:var(--primary-background-color);border:var(--border-color) 1px solid;border-radius:var(--border-radius);box-shadow:0 4px 12px #00000026;max-height:200px;overflow:hidden;margin-top:2px}.combobox-options{max-height:200px;overflow-y:auto;padding:2px 0}.combobox-option{padding:8px 12px;cursor:pointer;color:var(--text-color);background:var(--primary-background-color);transition:background-color .1s ease;font-size:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.combobox-option:hover,.combobox-option.focused{background:var(--hover-background-color)}.combobox-option:active{background:var(--active-bg)}.combobox-no-options{padding:8px 12px;color:var(--text-secondary);font-style:italic;text-align:center}.dark .combobox-dropdown{box-shadow:0 4px 12px #0000004d}.combobox-options::-webkit-scrollbar{width:6px}.combobox-options::-webkit-scrollbar-track{background:var(--bg-secondary)}.combobox-options::-webkit-scrollbar-thumb{background:var(--border-color);border-radius:3px}.combobox-options::-webkit-scrollbar-thumb:hover{background:var(--text-secondary)}.custom-combobox[data-type=font] .combobox-option{font-size:14px;padding:10px 12px}.custom-combobox[data-type=font] .combobox-input{transition:font-family .2s ease,border-color .2s ease}.custom-combobox[data-type=style] .combobox-option{font-family:inherit}@media (max-width: 600px){.combobox-dropdown,.combobox-options{max-height:150px}}</style>
  </head>
  <body>
      <div id="title-bar">
        <button id="show-replace-button" class="toggle-button" title="החלף">
          <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2052%2052'%20fill='currentColor'%3e%3cpath%20d='M%2020%2037.5%20c%200%20-0.8%20-0.7%20-1.5%20-1.5%20-1.5%20h%20-15%20C%202.7%2036%202%2036.7%202%2037.5%20v%2011%20C%202%2049.3%202.7%2050%203.5%2050%20h%2015%20c%200.8%200%201.5%20-0.7%201.5%20-1.5%20V%2037.5%20z%20M%208.1%2022%20H%203.2%20c%20-1%200%20-1.5%200.9%20-0.9%201.4%20l%208%208.3%20c%200.4%200.3%201%200.3%201.4%200%20l%208%20-8.3%20c%200.6%20-0.6%200.1%20-1.4%20-0.9%20-1.4%20h%20-4.7%20c%200%20-5%204.9%20-10%209.9%20-10%20V%206%20C%2015%206%208.1%2013%208.1%2022%20z%20M%2041.8%2020.3%20c%20-0.4%20-0.3%20-1%20-0.3%20-1.4%200%20l%20-8%208.3%20c%20-0.6%200.6%20-0.1%201.4%200.9%201.4%20h%204.8%20c%200%206%20-4.1%2010%20-10.1%2010%20v%206%20c%209%200%2016.1%20-7%2016.1%20-16%20H%2049%20c%201%200%201.5%20-0.9%200.9%20-1.4%20L%2041.8%2020.3%20z%20M%2050%203.5%20C%2050%202.7%2049.3%202%2048.5%202%20h%20-15%20C%2032.7%202%2032%202.7%2032%203.5%20v%2011%20c%200%200.8%200.7%201.5%201.5%201.5%20h%2015%20c%200.8%200%201.5%20-0.7%201.5%20-1.5%20V%203.5%20z'/%3e%3c/svg%3e" class="icon" />
          <span>החלפה</span>
        </button>

        <div id="search-options-group" class="flex-row">
          <select id="search-mode-select" title="כיוון החיפוש">
            <option value="All">הכל</option>
            <option value="Forward">כלפי מטה</option>
            <option value="Back">כלפי מעלה</option>
            <option value="Selection">לפי בחירה</option>
          </select>

          <label id="slop-input-label" for="slop-input">מרחק:</label>
          <input type="number" id="slop-input" min="0" value="0" class="slop-input" title="מרחק בין מילים" />
        </div>

        <div id="help-buttons-group" class="flex-row">
          <button id="theme-toggle-button" class="icon-button" title="החלף ערכת נושא">
            <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%3e%3ccircle%20cx='10'%20cy='10'%20r='8'%20stroke='currentColor'%20stroke-width='1.5'%20/%3e%3cpath%20d='M10%202%20A8%208%200%200%201%2010%2018%20Z'%20fill='currentColor'%20/%3e%3c/svg%3e" class="icon" />
          </button>

          <button id="help-toggle-button" class="icon-button toggle-button" title="לוח תווי רג'קס">
            <img src="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20width='16'%20height='16'%20fill='currentColor'%3e%3cpath%20d='M16,16.92C15.67,16.97%2015.34,17%2015,17C14.66,17%2014.33,16.97%2014,16.92V13.41L11.5,15.89C11,15.5%2010.5,15%2010.11,14.5L12.59,12H9.08C9.03,11.67%209,11.34%209,11C9,10.66%209.03,10.33%209.08,10H12.59L10.11,7.5C10.3,7.25%2010.5,7%2010.76,6.76V6.76C11,6.5%2011.25,6.3%2011.5,6.11L14,8.59V5.08C14.33,5.03%2014.66,5%2015,5C15.34,5%2015.67,5.03%2016,5.08V8.59L18.5,6.11C19,6.5%2019.5,7%2019.89,7.5L17.41,10H20.92C20.97,10.33%2021,10.66%2021,11C21,11.34%2020.97,11.67%2020.92,12H17.41L19.89,14.5C19.7,14.75%2019.5,15%2019.24,15.24V15.24C19,15.5%2018.75,15.7%2018.5,15.89L16,13.41V16.92H16V16.92M5,19A2,2%200%200,1%207,17A2,2%200%200,1%209,19A2,2%200%200,1%207,21A2,2%200%200,1%205,19H5Z'/%3e%3c/svg%3e" class="icon" />
          </button>

          <button id="about-button" class="icon-button" title="אודות">
            <img src="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20fill='none'%20viewBox='0%200%2024%2024'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M12%201.999c5.524%200%2010.002%204.478%2010.002%2010.002%200%205.523-4.478%2010.001-10.002%2010.001-5.524%200-10.002-4.478-10.002-10.001C1.998%206.477%206.476%201.999%2012%201.999Zm0%201.5a8.502%208.502%200%201%200%200%2017.003A8.502%208.502%200%200%200%2012%203.5Zm-.004%207a.75.75%200%200%201%20.744.648l.007.102.003%205.502a.75.75%200%200%201-1.493.102l-.007-.101-.003-5.502a.75.75%200%200%201%20.75-.75ZM12%207.003a.999.999%200%201%201%200%201.997.999.999%200%200%201%200-1.997Z'%20fill='%23000000'/%3e%3c/svg%3e" class="icon" />
          </button>
        </div>
      </div>

      <div id="content">
        <!-- find area -->
        <div id="search-find-container" class="container">
          <div class="input-wrapper">
            <input type="text" id="find-text-input" placeholder="חיפוש..." class="search-input" title="חיפוש" />
            <datalist id="search-history-datalist"></datalist>
            <button id="find-button" class="search-button" title="חיפוש">
              <img src="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20fill='none'%20viewBox='0%200%2024%2024'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M10%202.75a7.25%207.25%200%200%201%205.63%2011.819l4.9%204.9a.75.75%200%200%201-.976%201.134l-.084-.073-4.901-4.9A7.25%207.25%200%201%201%2010%202.75Zm0%201.5a5.75%205.75%200%201%200%200%2011.5%205.75%205.75%200%200%200%200-11.5Z'%20fill='%23212121'/%3e%3c/svg%3e" class="icon" />
            </button>
            <button id="regex-toggle-button" class="toggle-button search-button" title="השתמש בתווים כלליים">
              <img src="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20width='16'%20height='16'%20fill='currentColor'%3e%3cpath%20d='M16,16.92C15.67,16.97%2015.34,17%2015,17C14.66,17%2014.33,16.97%2014,16.92V13.41L11.5,15.89C11,15.5%2010.5,15%2010.11,14.5L12.59,12H9.08C9.03,11.67%209,11.34%209,11C9,10.66%209.03,10.33%209.08,10H12.59L10.11,7.5C10.3,7.25%2010.5,7%2010.76,6.76V6.76C11,6.5%2011.25,6.3%2011.5,6.11L14,8.59V5.08C14.33,5.03%2014.66,5%2015,5C15.34,5%2015.67,5.03%2016,5.08V8.59L18.5,6.11C19,6.5%2019.5,7%2019.89,7.5L17.41,10H20.92C20.97,10.33%2021,10.66%2021,11C21,11.34%2020.97,11.67%2020.92,12H17.41L19.89,14.5C19.7,14.75%2019.5,15%2019.24,15.24V15.24C19,15.5%2018.75,15.7%2018.5,15.89L16,13.41V16.92H16V16.92M5,19A2,2%200%200,1%207,17A2,2%200%200,1%209,19A2,2%200%200,1%207,21A2,2%200%200,1%205,19H5Z'/%3e%3c/svg%3e" class="icon" />
            </button>
          </div>

          <div id="find-options-wrapper" class="flex-row">
            <input
              type="number"
              id="find-font-size-input"
              min="8"
              max="72"
              value="12"
              class="font-size-input"
              title="גודל גופן"
            />

            <button id="find-bold-toggle" class="format-btn toggle-button" title="מודגש">
              <img src="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20fill='none'%20viewBox='0%200%2024%2024'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M6.935%204.44A1.5%201.5%200%200%201%207.996%204h4.383C15.017%204%2017%206.182%2017%208.625a4.63%204.63%200%200%201-.865%202.682c1.077.827%201.866%202.12%201.866%203.813C18%2018.232%2015.3%2020%2013.12%2020H8a1.5%201.5%200%200%201-1.5-1.5l-.004-13c0-.397.158-.779.44-1.06ZM9.5%2010.25h2.88c.903%200%201.62-.76%201.62-1.625S13.281%207%2012.38%207H9.498l.002%203.25Zm0%203V17h3.62c.874%200%201.88-.754%201.88-1.88%200-1.13-.974-1.87-1.88-1.87H9.5Z'%20fill='%23000000'/%3e%3c/svg%3e" class="icon" />
            </button>
            <button id="find-italic-toggle" class="format-btn toggle-button" title="נטוי">
              <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='currentColor'%3e%3cpath%20d='M10,4V7H12.21L8.79,15H6V18H14V15H11.79L15.21,7H18V4H10Z'/%3e%3c/svg%3e" class="icon" />
            </button>
            <button id="find-underline-toggle" class="format-btn toggle-button" title="קו תחתון">
              <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='currentColor'%3e%3cpath%20d='M5,21H19V19H5V21M12,17A6,6%200%200,0%2018,11V3H15.5V11A3.5,3.5%200%200,1%2012,14.5A3.5,3.5%200%200,1%208.5,11V3H6V11A6,6%200%200,0%2012,17Z'/%3e%3c/svg%3e" class="icon" />
            </button>
            <button id="find-subscript-toggle" class="format-btn toggle-button" title="כתב תחתי">
              <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='currentColor'%3e%3cpath%20d='M16,7.41L11.41,12L16,16.59L14.59,18L10,13.41L5.41,18L4,16.59L8.59,12L4,7.41L5.41,6L10,10.59L14.59,6L16,7.41M21.85,21.03H16.97V20.03L17.86,19.23C18.62,18.58%2019.18,18.04%2019.56,17.6C19.93,17.16%2020.12,16.75%2020.13,16.36C20.14,16.08%2020.05,15.85%2019.86,15.66C19.68,15.5%2019.39,15.38%2019,15.38C18.69,15.38%2018.42,15.44%2018.16,15.56L17.5,15.94L17.05,14.77C17.32,14.56%2017.64,14.38%2018.03,14.24C18.42,14.1%2018.85,14%2019.32,14C20.1,14.04%2020.7,14.25%2021.1,14.66C21.5,15.07%2021.72,15.59%2021.72,16.23C21.71,16.79%2021.53,17.31%2021.18,17.78C20.84,18.25%2020.42,18.7%2019.91,19.14L19.27,19.66V19.68H21.85V21.03Z'/%3e%3c/svg%3e" class="icon" />
            </button>
            <button id="find-superscript-toggle" class="format-btn toggle-button" title="כתב עילי">
              <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='currentColor'%3e%3cpath%20d='M16,7.41L11.41,12L16,16.59L14.59,18L10,13.41L5.41,18L4,16.59L8.59,12L4,7.41L5.41,6L10,10.59L14.59,6L16,7.41M21.85,9H16.97V8L17.86,7.18C18.62,6.54%2019.18,6%2019.56,5.55C19.93,5.11%2020.12,4.7%2020.13,4.32C20.14,4.04%2020.05,3.8%2019.86,3.62C19.68,3.43%2019.39,3.34%2019,3.33C18.69,3.34%2018.42,3.4%2018.16,3.5L17.5,3.89L17.05,2.72C17.32,2.5%2017.64,2.33%2018.03,2.19C18.42,2.05%2018.85,2%2019.32,2C20.1,2%2020.7,2.2%2021.1,2.61C21.5,3%2021.72,3.54%2021.72,4.18C21.71,4.74%2021.53,5.26%2021.18,5.73C20.84,6.21%2020.42,6.66%2019.91,7.09L19.27,7.61V7.63H21.85V9Z'/%3e%3c/svg%3e" class="icon" />
            </button>
            <button id="find-color-button" class="format-btn color-btn" title="צבע גופן">
              <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='currentColor'%3e%3cpath%20d='M3.839%205.858c2.94-3.916%209.03-5.055%2013.364-2.36%204.28%202.66%205.854%207.777%204.1%2012.577-1.655%204.533-6.016%206.328-9.159%204.048-1.177-.854-1.634-1.925-1.854-3.664l-.106-.987-.045-.398c-.123-.934-.311-1.352-.705-1.572-.535-.298-.892-.305-1.595-.033l-.351.146-.179.078c-1.014.44-1.688.595-2.541.416l-.2-.047-.164-.047c-2.789-.864-3.202-4.647-.565-8.157Zm.984%206.716.123.037.134.03c.439.087.814.015%201.437-.242l.602-.257c1.202-.493%201.985-.54%203.046.05.917.512%201.275%201.298%201.457%202.66l.053.459.055.532.047.422c.172%201.361.485%202.09%201.248%202.644%202.275%201.65%205.534.309%206.87-3.349%201.516-4.152.174-8.514-3.484-10.789-3.675-2.284-8.899-1.306-11.373%201.987-2.075%202.763-1.82%205.28-.215%205.816Zm11.225-1.994a1.25%201.25%200%201%201%202.414-.647%201.25%201.25%200%200%201-2.414.647Zm.494%203.488a1.25%201.25%200%201%201%202.415-.647%201.25%201.25%200%200%201-2.415.647ZM14.07%207.577a1.25%201.25%200%201%201%202.415-.647%201.25%201.25%200%200%201-2.415.647Zm-.028%208.998a1.25%201.25%200%201%201%202.414-.647%201.25%201.25%200%200%201-2.414.647Zm-3.497-9.97a1.25%201.25%200%201%201%202.415-.646%201.25%201.25%200%200%201-2.415.646Z'/%3e%3c/svg%3e" class="icon" />
            </button>
            <button id="find-clear-button" class="format-btn" title="נקה הגדרות עיצוב">
              <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='currentColor'%3e%3cpath%20d='M16.24,3.56L21.19,8.5C21.97,9.29%2021.97,10.55%2021.19,11.34L12,20.53C10.44,22.09%207.91,22.09%206.34,20.53L2.81,17C2.03,16.21%202.03,14.95%202.81,14.16L13.41,3.56C14.2,2.78%2015.46,2.78%2016.24,3.56M4.22,15.58L7.76,19.11C8.54,19.9%209.8,19.9%2010.59,19.11L14.12,15.58L9.17,10.63L4.22,15.58Z'/%3e%3c/svg%3e" class="icon" />
            </button>
            <button id="find-dipper-button" class="format-btn" title="שאב הגדרות עיצוב">
              <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='currentColor'%3e%3cpath%20d='M19.35,11.72L17.22,13.85L15.81,12.43L8.1,20.14L3.5,22L2,20.5L3.86,15.9L11.57,8.19L10.15,6.78L12.28,4.65L19.35,11.72M16.76,3C17.93,1.83%2019.83,1.83%2021,3C22.17,4.17%2022.17,6.07%2021,7.24L19.08,9.16L14.84,4.92L16.76,3M5.56,17.03L4.5,19.5L6.97,18.44L14.4,11L13,9.6L5.56,17.03Z'/%3e%3c/svg%3e" class="icon" />
            </button>
          </div>

          <div id="find-font-style-wrapper" class="flex-row">
            <custom-combobox 
                id="find-style-input" 
                type="style" 
                placeholder="בחר סגנון">
            </custom-combobox>

            <custom-combobox 
                id="find-font-input" 
                type="font" 
                placeholder="בחר גופן">
            </custom-combobox>
          </div>
        </div>

        <!-- replace area -->
        <div id="search-replace-container" class="container">
          <div class="input-wrapper">
            <input type="text" id="replace-text-input" placeholder="החלף ב.." class="search-input" title="החלף ב.." />
            <button id="replace-button" class="search-replace-button" title="החלף">
              <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='2%202%2020%2020'%20fill='currentColor'%3e%3cpath%20d='M11,6C12.38,6%2013.63,6.56%2014.54,7.46L12,10H18V4L15.95,6.05C14.68,4.78%2012.93,4%2011,4C7.47,4%204.57,6.61%204.08,10H6.1C6.56,7.72%208.58,6%2011,6M16.64,15.14C17.3,14.24%2017.76,13.17%2017.92,12H15.9C15.44,14.28%2013.42,16%2011,16C9.62,16%208.37,15.44%207.46,14.54L10,12H4V18L6.05,15.95C7.32,17.22%209.07,18%2011,18C12.55,18%2014,17.5%2015.14,16.64L20,21.5L21.5,20L16.64,15.14Z'/%3e%3c/svg%3e" class="icon" />
            </button>
            <button id="replace-all-button" class="search-replace-button" title="החלף הכל">
              <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2052%2052'%20fill='currentColor'%3e%3cpath%20d='M%2020%2037.5%20c%200%20-0.8%20-0.7%20-1.5%20-1.5%20-1.5%20h%20-15%20C%202.7%2036%202%2036.7%202%2037.5%20v%2011%20C%202%2049.3%202.7%2050%203.5%2050%20h%2015%20c%200.8%200%201.5%20-0.7%201.5%20-1.5%20V%2037.5%20z%20M%208.1%2022%20H%203.2%20c%20-1%200%20-1.5%200.9%20-0.9%201.4%20l%208%208.3%20c%200.4%200.3%201%200.3%201.4%200%20l%208%20-8.3%20c%200.6%20-0.6%200.1%20-1.4%20-0.9%20-1.4%20h%20-4.7%20c%200%20-5%204.9%20-10%209.9%20-10%20V%206%20C%2015%206%208.1%2013%208.1%2022%20z%20M%2041.8%2020.3%20c%20-0.4%20-0.3%20-1%20-0.3%20-1.4%200%20l%20-8%208.3%20c%20-0.6%200.6%20-0.1%201.4%200.9%201.4%20h%204.8%20c%200%206%20-4.1%2010%20-10.1%2010%20v%206%20c%209%200%2016.1%20-7%2016.1%20-16%20H%2049%20c%201%200%201.5%20-0.9%200.9%20-1.4%20L%2041.8%2020.3%20z%20M%2050%203.5%20C%2050%202.7%2049.3%202%2048.5%202%20h%20-15%20C%2032.7%202%2032%202.7%2032%203.5%20v%2011%20c%200%200.8%200.7%201.5%201.5%201.5%20h%2015%20c%200.8%200%201.5%20-0.7%201.5%20-1.5%20V%203.5%20z'/%3e%3c/svg%3e" class="icon" />
            </button>
          </div>

          <div id="replace-options-wrapper" class="flex-row">
            <input
              type="number"
              id="replace-font-size-input"
              min="8"
              max="72"
              value="12"
              class="font-size-input"
              title="גודל גופן"
            />

            <button id="replace-bold-toggle" class="format-btn toggle-button" title="מודגש">
              <img src="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20fill='none'%20viewBox='0%200%2024%2024'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M6.935%204.44A1.5%201.5%200%200%201%207.996%204h4.383C15.017%204%2017%206.182%2017%208.625a4.63%204.63%200%200%201-.865%202.682c1.077.827%201.866%202.12%201.866%203.813C18%2018.232%2015.3%2020%2013.12%2020H8a1.5%201.5%200%200%201-1.5-1.5l-.004-13c0-.397.158-.779.44-1.06ZM9.5%2010.25h2.88c.903%200%201.62-.76%201.62-1.625S13.281%207%2012.38%207H9.498l.002%203.25Zm0%203V17h3.62c.874%200%201.88-.754%201.88-1.88%200-1.13-.974-1.87-1.88-1.87H9.5Z'%20fill='%23000000'/%3e%3c/svg%3e" class="icon" />
            </button>
            <button id="replace-italic-toggle" class="format-btn toggle-button" title="נטוי">
              <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='currentColor'%3e%3cpath%20d='M10,4V7H12.21L8.79,15H6V18H14V15H11.79L15.21,7H18V4H10Z'/%3e%3c/svg%3e" class="icon" />
            </button>
            <button id="replace-underline-toggle" class="format-btn toggle-button" title="קו תחתון">
              <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='currentColor'%3e%3cpath%20d='M5,21H19V19H5V21M12,17A6,6%200%200,0%2018,11V3H15.5V11A3.5,3.5%200%200,1%2012,14.5A3.5,3.5%200%200,1%208.5,11V3H6V11A6,6%200%200,0%2012,17Z'/%3e%3c/svg%3e" class="icon" />
            </button>
            <button id="replace-subscript-toggle" class="format-btn toggle-button" title="כתב תחתי">
              <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='currentColor'%3e%3cpath%20d='M16,7.41L11.41,12L16,16.59L14.59,18L10,13.41L5.41,18L4,16.59L8.59,12L4,7.41L5.41,6L10,10.59L14.59,6L16,7.41M21.85,21.03H16.97V20.03L17.86,19.23C18.62,18.58%2019.18,18.04%2019.56,17.6C19.93,17.16%2020.12,16.75%2020.13,16.36C20.14,16.08%2020.05,15.85%2019.86,15.66C19.68,15.5%2019.39,15.38%2019,15.38C18.69,15.38%2018.42,15.44%2018.16,15.56L17.5,15.94L17.05,14.77C17.32,14.56%2017.64,14.38%2018.03,14.24C18.42,14.1%2018.85,14%2019.32,14C20.1,14.04%2020.7,14.25%2021.1,14.66C21.5,15.07%2021.72,15.59%2021.72,16.23C21.71,16.79%2021.53,17.31%2021.18,17.78C20.84,18.25%2020.42,18.7%2019.91,19.14L19.27,19.66V19.68H21.85V21.03Z'/%3e%3c/svg%3e" class="icon" />
            </button>
            <button id="replace-superscript-toggle" class="format-btn toggle-button" title="כתב עילי">
              <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='currentColor'%3e%3cpath%20d='M16,7.41L11.41,12L16,16.59L14.59,18L10,13.41L5.41,18L4,16.59L8.59,12L4,7.41L5.41,6L10,10.59L14.59,6L16,7.41M21.85,9H16.97V8L17.86,7.18C18.62,6.54%2019.18,6%2019.56,5.55C19.93,5.11%2020.12,4.7%2020.13,4.32C20.14,4.04%2020.05,3.8%2019.86,3.62C19.68,3.43%2019.39,3.34%2019,3.33C18.69,3.34%2018.42,3.4%2018.16,3.5L17.5,3.89L17.05,2.72C17.32,2.5%2017.64,2.33%2018.03,2.19C18.42,2.05%2018.85,2%2019.32,2C20.1,2%2020.7,2.2%2021.1,2.61C21.5,3%2021.72,3.54%2021.72,4.18C21.71,4.74%2021.53,5.26%2021.18,5.73C20.84,6.21%2020.42,6.66%2019.91,7.09L19.27,7.61V7.63H21.85V9Z'/%3e%3c/svg%3e" class="icon" />
            </button>
            <button id="replace-color-toggle" class="format-btn color-btn" title="צבע גופן">
              <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='currentColor'%3e%3cpath%20d='M3.839%205.858c2.94-3.916%209.03-5.055%2013.364-2.36%204.28%202.66%205.854%207.777%204.1%2012.577-1.655%204.533-6.016%206.328-9.159%204.048-1.177-.854-1.634-1.925-1.854-3.664l-.106-.987-.045-.398c-.123-.934-.311-1.352-.705-1.572-.535-.298-.892-.305-1.595-.033l-.351.146-.179.078c-1.014.44-1.688.595-2.541.416l-.2-.047-.164-.047c-2.789-.864-3.202-4.647-.565-8.157Zm.984%206.716.123.037.134.03c.439.087.814.015%201.437-.242l.602-.257c1.202-.493%201.985-.54%203.046.05.917.512%201.275%201.298%201.457%202.66l.053.459.055.532.047.422c.172%201.361.485%202.09%201.248%202.644%202.275%201.65%205.534.309%206.87-3.349%201.516-4.152.174-8.514-3.484-10.789-3.675-2.284-8.899-1.306-11.373%201.987-2.075%202.763-1.82%205.28-.215%205.816Zm11.225-1.994a1.25%201.25%200%201%201%202.414-.647%201.25%201.25%200%200%201-2.414.647Zm.494%203.488a1.25%201.25%200%201%201%202.415-.647%201.25%201.25%200%200%201-2.415.647ZM14.07%207.577a1.25%201.25%200%201%201%202.415-.647%201.25%201.25%200%200%201-2.415.647Zm-.028%208.998a1.25%201.25%200%201%201%202.414-.647%201.25%201.25%200%200%201-2.414.647Zm-3.497-9.97a1.25%201.25%200%201%201%202.415-.646%201.25%201.25%200%200%201-2.415.646Z'/%3e%3c/svg%3e" class="icon" />
            </button>
            <button id="replace-options-clear-button" class="format-btn" title="נקה הגדרות עיצוב">
              <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='currentColor'%3e%3cpath%20d='M16.24,3.56L21.19,8.5C21.97,9.29%2021.97,10.55%2021.19,11.34L12,20.53C10.44,22.09%207.91,22.09%206.34,20.53L2.81,17C2.03,16.21%202.03,14.95%202.81,14.16L13.41,3.56C14.2,2.78%2015.46,2.78%2016.24,3.56M4.22,15.58L7.76,19.11C8.54,19.9%209.8,19.9%2010.59,19.11L14.12,15.58L9.17,10.63L4.22,15.58Z'/%3e%3c/svg%3e" class="icon" />
            </button>
            <button id="replace-options-dipper-button" class="format-btn" title="שאב הגדרות עיצוב">
              <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='currentColor'%3e%3cpath%20d='M19.35,11.72L17.22,13.85L15.81,12.43L8.1,20.14L3.5,22L2,20.5L3.86,15.9L11.57,8.19L10.15,6.78L12.28,4.65L19.35,11.72M16.76,3C17.93,1.83%2019.83,1.83%2021,3C22.17,4.17%2022.17,6.07%2021,7.24L19.08,9.16L14.84,4.92L16.76,3M5.56,17.03L4.5,19.5L6.97,18.44L14.4,11L13,9.6L5.56,17.03Z'/%3e%3c/svg%3e" class="icon" />
            </button>
          </div>

          <div id="replace-font-style-wrapper" class="flex-row">
            <custom-combobox 
                id="replace-style-input" 
                type="style" 
                placeholder="בחר סגנון">
            </custom-combobox>

            <custom-combobox 
                id="replace-font-input" 
                type="font" 
                placeholder="בחר גופן">
            </custom-combobox>
          </div>
        </div>

        <div id="results-container">
          <!-- Regex Palette (hidden by default) -->
          <div id="regex-palette" class="regex-palette" style="display: none">
            <div class="regex-grid" id="regex-grid">
              <!-- Regex tips will be populated by JavaScript -->
            </div>
          </div>

          <!-- Search Results -->
          <div id="search-results" class="search-results">
            <div class="results-list" id="results-list-content"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Color Picker Dialog -->
    <div id="color-picker-overlay" class="color-picker-overlay" style="display: none">
      <div id="color-picker" class="color-picker">
        <div class="color-picker-header">
          <span>צבע גופן</span>
          <button class="close-btn" id="color-picker-close">×</button>
        </div>

        <div class="color-picker-content">
          <!-- Auto and No Color buttons -->
          <div class="auto-no-colors">
            <button class="color-option auto-color" data-color="#000000">
              <div class="color-preview" style="background-color: #000000"></div>
              <span>אוטומטי</span>
            </button>
            <button class="color-option no-color" data-color="null">
              <div class="color-preview no-color-preview"></div>
              <span>ללא צבע</span>
            </button>
          </div>

          <div class="separator"></div>

          <!-- Theme Colors -->
          <div class="color-section">
            <div class="section-title">צבעי ערכת נושא</div>
            <div class="theme-colors-container" id="theme-colors-grid">
              <!-- Theme colors will be populated by JavaScript -->
              <!-- First row: Base theme colors -->
              <!-- Following rows: Tint/shade variations -->
            </div>
          </div>

          <div class="separator"></div>

          <!-- Standard Office Colors -->
          <div class="color-section">
            <div class="section-title">צבעי אופיס סטנדרטים</div>
            <div class="color-grid" id="standard-colors-grid">
              <!-- Standard colors will be populated by JavaScript -->
            </div>
          </div>

          <div class="separator"></div>

          <!-- More Colors -->
          <button class="more-colors-btn" id="more-colors-btn">
            <img src="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='currentColor'%3e%3cpath%20d='M3.839%205.858c2.94-3.916%209.03-5.055%2013.364-2.36%204.28%202.66%205.854%207.777%204.1%2012.577-1.655%204.533-6.016%206.328-9.159%204.048-1.177-.854-1.634-1.925-1.854-3.664l-.106-.987-.045-.398c-.123-.934-.311-1.352-.705-1.572-.535-.298-.892-.305-1.595-.033l-.351.146-.179.078c-1.014.44-1.688.595-2.541.416l-.2-.047-.164-.047c-2.789-.864-3.202-4.647-.565-8.157Zm.984%206.716.123.037.134.03c.439.087.814.015%201.437-.242l.602-.257c1.202-.493%201.985-.54%203.046.05.917.512%201.275%201.298%201.457%202.66l.053.459.055.532.047.422c.172%201.361.485%202.09%201.248%202.644%202.275%201.65%205.534.309%206.87-3.349%201.516-4.152.174-8.514-3.484-10.789-3.675-2.284-8.899-1.306-11.373%201.987-2.075%202.763-1.82%205.28-.215%205.816Zm11.225-1.994a1.25%201.25%200%201%201%202.414-.647%201.25%201.25%200%200%201-2.414.647Zm.494%203.488a1.25%201.25%200%201%201%202.415-.647%201.25%201.25%200%200%201-2.415.647ZM14.07%207.577a1.25%201.25%200%201%201%202.415-.647%201.25%201.25%200%200%201-2.415.647Zm-.028%208.998a1.25%201.25%200%201%201%202.414-.647%201.25%201.25%200%200%201-2.414.647Zm-3.497-9.97a1.25%201.25%200%201%201%202.415-.646%201.25%201.25%200%200%201-2.415.646Z'/%3e%3c/svg%3e" class="icon" style="width: 16px; height: 16px" />
            <span>צבעים נוספים...</span>
          </button>
        </div>
      </div>
    </div>

  </body>
</html>
